<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Site Performance Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
        }
        

        
        .dashboard-iframe {
            border: none;
            width: 100%;
            height: 100%;
        }
        
        /* Hide Looker Studio branding */
        .dashboard-iframe::after {
            content: '';
            position: absolute;
            bottom: 0;
            right: 0;
            width: 200px;
            height: 30px;
            background: white;
            z-index: 10;
        }
        
        .iframe-container {
            position: relative;
            overflow: hidden;
        }
        
        .iframe-container::after {
            content: '';
            position: absolute;
            bottom: 0;
            right: 0;
            width: 200px;
            height: 30px;
            background: #f8fafc;
            z-index: 10;
            pointer-events: none;
        }
        
        @media (max-width: 768px) {
            .iframe-container::after {
                width: 150px;
                height: 25px;
            }
        }
    </style>
</head>
<body class="bg-slate-50 min-h-screen flex flex-col">


    <!-- Main Dashboard Content -->
    <main class="flex-1 p-0 md:p-6">
        <div class="bg-white md:rounded-lg md:shadow-lg h-full">
            <div class="iframe-container h-full md:rounded-lg overflow-hidden">
                <iframe 
                    class="dashboard-iframe"
                    src="https://lookerstudio.google.com/embed/reporting/41cb1705-eba5-4859-b9c7-1efd1184629c/page/sspUF" 
                    frameborder="0" 
                    style="border:0; min-height: 100vh;" 
                    allowfullscreen 
                    sandbox="allow-storage-access-by-user-activation allow-scripts allow-same-origin allow-popups allow-popups-to-escape-sandbox">
                </iframe>
            </div>
        </div>
    </main>



    <script>
        let userTimezone = 'America/New_York';
        let userLocation = 'Loading...';
        let weatherData = { temp: '--', condition: 'Loading...' };

        // Update time with user's timezone
        function updateTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('en-US', {
                timeZone: userTimezone,
                hour: 'numeric',
                minute: '2-digit',
                hour12: true
            });
            
            document.getElementById('current-time').textContent = timeString;
        }

        // Get user's location and fetch weather
        async function getUserLocationAndWeather() {
            if (!navigator.geolocation) {
                console.log('Geolocation not supported');
                return;
            }

            try {
                // Get user's coordinates
                const position = await new Promise((resolve, reject) => {
                    navigator.geolocation.getCurrentPosition(resolve, reject, {
                        timeout: 10000,
                        enableHighAccuracy: true
                    });
                });

                const { latitude, longitude } = position.coords;
                
                // Get location name using reverse geocoding
                await getLocationName(latitude, longitude);
                
                // Get weather data
                await getWeatherData(latitude, longitude);
                
                // Get timezone
                await getTimezone(latitude, longitude);
                
            } catch (error) {
                console.log('Location access denied or failed:', error);
                // Fallback to IP-based location
                await getLocationByIP();
            }
        }

        // Reverse geocoding to get location name
        async function getLocationName(lat, lon) {
            try {
                const response = await fetch(`https://api.bigdatacloud.net/data/reverse-geocode-client?latitude=${lat}&longitude=${lon}&localityLanguage=en`);
                const data = await response.json();
                
                const city = data.city || data.locality || 'Unknown City';
                const region = data.principalSubdivision || data.countryName || '';
                userLocation = region ? `${city}, ${region}` : city;
                
                document.getElementById('location').textContent = userLocation;
            } catch (error) {
                console.log('Geocoding failed:', error);
            }
        }

        // Get weather data using Open-Meteo (free API)
        async function getWeatherData(lat, lon) {
            try {
                const response = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true&temperature_unit=fahrenheit`);
                const data = await response.json();
                
                if (data.current_weather) {
                    const temp = Math.round(data.current_weather.temperature);
                    const weatherCode = data.current_weather.weathercode;
                    const condition = getWeatherCondition(weatherCode);
                    
                    weatherData = { temp: `${temp}°F`, condition };
                    document.getElementById('weather').textContent = `${temp}°F ${condition}`;
                }
            } catch (error) {
                console.log('Weather fetch failed:', error);
                document.getElementById('weather').textContent = 'Weather unavailable';
            }
        }

        // Get timezone based on coordinates
        async function getTimezone(lat, lon) {
            try {
                // Using a simple timezone estimation based on longitude
                const timezoneOffset = Math.round(lon / 15);
                const timezones = {
                    '-8': 'America/Los_Angeles',
                    '-7': 'America/Denver',
                    '-6': 'America/Chicago',
                    '-5': 'America/New_York',
                    '0': 'Europe/London',
                    '1': 'Europe/Paris',
                    '8': 'Asia/Shanghai',
                    '9': 'Asia/Tokyo'
                };
                
                userTimezone = timezones[timezoneOffset.toString()] || 'America/New_York';
            } catch (error) {
                console.log('Timezone detection failed:', error);
            }
        }

        // Fallback: Get location by IP
        async function getLocationByIP() {
            try {
                const response = await fetch('https://ipapi.co/json/');
                const data = await response.json();
                
                if (data.city && data.region) {
                    userLocation = `${data.city}, ${data.region}`;
                    document.getElementById('location').textContent = userLocation;
                    
                    // Get weather for IP location
                    if (data.latitude && data.longitude) {
                        await getWeatherData(data.latitude, data.longitude);
                        await getTimezone(data.latitude, data.longitude);
                    }
                }
            } catch (error) {
                console.log('IP location failed:', error);
                userLocation = 'Location unavailable';
                document.getElementById('location').textContent = userLocation;
            }
        }

        // Convert weather codes to readable conditions
        function getWeatherCondition(code) {
            const conditions = {
                0: 'Clear',
                1: 'Mostly Clear',
                2: 'Partly Cloudy',
                3: 'Overcast',
                45: 'Foggy',
                48: 'Foggy',
                51: 'Light Drizzle',
                53: 'Drizzle',
                55: 'Heavy Drizzle',
                61: 'Light Rain',
                63: 'Rain',
                65: 'Heavy Rain',
                71: 'Light Snow',
                73: 'Snow',
                75: 'Heavy Snow',
                80: 'Light Showers',
                81: 'Showers',
                82: 'Heavy Showers',
                95: 'Thunderstorm'
            };
            
            return conditions[code] || 'Unknown';
        }



        // Initialize everything
        async function initialize() {
            // Start time updates immediately
            updateTime();
            setInterval(updateTime, 1000);
            
            // Get location and weather
            await getUserLocationAndWeather();
            
            // Update weather every 10 minutes
            setInterval(getUserLocationAndWeather, 600000);
        }

        // Start when page loads
        initialize();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9700f0ecd37ac6ee',t:'MTc1NTM0NzQwNy4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
